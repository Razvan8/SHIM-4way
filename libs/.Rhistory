#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
assert(counter==1+ l1*l2(l3+l4) +l3*l4*(l1+l2))
return(psi)
}
get_psi_from_psi_vec4(psi_vec=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2),l1=1,l2=2,l3=2,l4=2)
get_psi_from_psi_vec4<-function(psi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
psi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in c(range3,range4) ) {
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
for (i in range1) {
for (j in range3 ) {
for (k in range4 ) {
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
for (i in range2) {
for (j in range3 ) {
for (k in range4 ) {
print(counter)
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
assert(counter==1+ l1*l2(l3+l4) +l3*l4*(l1+l2))
return(psi)
}
get_psi_from_psi_vec4(psi_vec=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2),l1=1,l2=2,l3=2,l4=2)
#get psi table from psi_vec
get_psi_from_psi_vec4<-function(psi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
psi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in c(range3,range4) ) {
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
for (i in range1) {
for (j in range3 ) {
for (k in range4 ) {
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
for (i in range2) {
for (j in range3 ) {
for (k in range4 ) {
print(counter)
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
psi[i,j,k]<-psi_vec[counter]/6
psi[i,k,j]<-psi_vec[counter]/6
psi[k,i,j]<-psi_vec[counter]/6
psi[k,j,i]<-psi_vec[counter]/6
psi[j,i,k]<-psi_vec[counter]/6
psi[j,k,i]<-psi_vec[counter]/6
counter<-counter+1
}}}
assert(counter==1+ l1*l2*(l3+l4) +l3*l4*(l1+l2))
return(psi)
}
get_psi_from_psi_vec4(psi_vec=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2),l1=1,l2=2,l3=2,l4=2)
get_psi_from_psi_vec4(psi_vec=6*c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2),l1=1,l2=2,l3=2,l4=2)
get_positions_3way4<-function(ls_positions, l1=21,l2=14,l3=2,l4=3)
{all_positions<-c()
for (tuple in ls_positions)
{pos<-psi_table_position_to_vector_index4(position_tuple = tuple, l1=l1, l2=l2, l3=l3,l4=l4)
#print(pos)
all_positions<-c(all_positions, pos)}
return(all_positions)}
ls_pos<-list(c(1,3,6), c(1,3,5), c(1,4,7), c(2,4,7))
get_positions_3way4(ls_pos, l1=1, l2=2, l3=3,l4=1)
ls_pos<-list(c(1,3,6), c(1,3,5), c(1,4,7), c(2,4,7), c(3,6,7))
get_positions_3way4(ls_pos, l1=1, l2=2, l3=3,l4=1)
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
#get psi table from psi_vec
get_phi_from_phi_vec4<-function(phi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
phi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in range3) {
for(l in range4){
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
phi[i,j,k,l]<-phi_vec[counter]/24
phi[i,j,l,k]<-phi_vec[counter]/24
phi[i,k,j,l]<-phi_vec[counter]/24
phi[i,k,l,j]<-phi_vec[counter]/24
phi[i,l,j,k]<-phi_vec[counter]/24
phi[i,l,k,j]<-phi_vec[counter]/24
phi[j,i,k,l]<-phi_vec[counter]/24
phi[j,i,l,k]<-phi_vec[counter]/24
phi[j,k,i,l]<-phi_vec[counter]/24
phi[j,k,l,i]<-phi_vec[counter]/24
phi[j,l,i,k]<-phi_vec[counter]/24
phi[j,l,k,i]<-phi_vec[counter]/24
phi[k,i,j,l]<-phi_vec[counter]/24
phi[k,i,l,j]<-phi_vec[counter]/24
phi[k,j,i,l]<-phi_vec[counter]/24
phi[k,j,l,i]<-phi_vec[counter]/24
phi[k,l,i,j]<-phi_vec[counter]/24
phi[k,l,j,i]<-phi_vec[counter]/24
phi[l,i,j,k]<-phi_vec[counter]/24
phi[l,i,k,j]<-phi_vec[counter]/24
phi[l,j,i,k]<-phi_vec[counter]/24
phi[l,j,k,i]<-phi_vec[counter]/24
phi[l,k,i,j]<-phi_vec[counter]/24
phi[l,k,j,i]<-phi_vec[counter]/24
counter<-counter+1
}}} }
assert(counter==1+ l1*l2*l3*l4 )
return(psi)
}
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
get_phi_from_phi_vec4<-function(phi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
phi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4, l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in range3) {
for(l in range4){
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
phi[i,j,k,l]<-phi_vec[counter]/24
phi[i,j,l,k]<-phi_vec[counter]/24
phi[i,k,j,l]<-phi_vec[counter]/24
phi[i,k,l,j]<-phi_vec[counter]/24
phi[i,l,j,k]<-phi_vec[counter]/24
phi[i,l,k,j]<-phi_vec[counter]/24
phi[j,i,k,l]<-phi_vec[counter]/24
phi[j,i,l,k]<-phi_vec[counter]/24
phi[j,k,i,l]<-phi_vec[counter]/24
phi[j,k,l,i]<-phi_vec[counter]/24
phi[j,l,i,k]<-phi_vec[counter]/24
phi[j,l,k,i]<-phi_vec[counter]/24
phi[k,i,j,l]<-phi_vec[counter]/24
phi[k,i,l,j]<-phi_vec[counter]/24
phi[k,j,i,l]<-phi_vec[counter]/24
phi[k,j,l,i]<-phi_vec[counter]/24
phi[k,l,i,j]<-phi_vec[counter]/24
phi[k,l,j,i]<-phi_vec[counter]/24
phi[l,i,j,k]<-phi_vec[counter]/24
phi[l,i,k,j]<-phi_vec[counter]/24
phi[l,j,i,k]<-phi_vec[counter]/24
phi[l,j,k,i]<-phi_vec[counter]/24
phi[l,k,i,j]<-phi_vec[counter]/24
phi[l,k,j,i]<-phi_vec[counter]/24
counter<-counter+1
}}} }
assert(counter==1+ l1*l2*l3*l4 )
return(psi)
}
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
x
c(1:24)
#get psi table from psi_vec
get_phi_from_phi_vec4<-function(phi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
phi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4, l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in range3) {
for(l in range4){
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
phi[i,j,k,l]<-phi_vec[counter]/24
phi[i,j,l,k]<-phi_vec[counter]/24
phi[i,k,j,l]<-phi_vec[counter]/24
phi[i,k,l,j]<-phi_vec[counter]/24
phi[i,l,j,k]<-phi_vec[counter]/24
phi[i,l,k,j]<-phi_vec[counter]/24
phi[j,i,k,l]<-phi_vec[counter]/24
phi[j,i,l,k]<-phi_vec[counter]/24
phi[j,k,i,l]<-phi_vec[counter]/24
phi[j,k,l,i]<-phi_vec[counter]/24
phi[j,l,i,k]<-phi_vec[counter]/24
phi[j,l,k,i]<-phi_vec[counter]/24
phi[k,i,j,l]<-phi_vec[counter]/24
phi[k,i,l,j]<-phi_vec[counter]/24
phi[k,j,i,l]<-phi_vec[counter]/24
phi[k,j,l,i]<-phi_vec[counter]/24
phi[k,l,i,j]<-phi_vec[counter]/24
phi[k,l,j,i]<-phi_vec[counter]/24
phi[l,i,j,k]<-phi_vec[counter]/24
phi[l,i,k,j]<-phi_vec[counter]/24
phi[l,j,i,k]<-phi_vec[counter]/24
phi[l,j,k,i]<-phi_vec[counter]/24
phi[l,k,i,j]<-phi_vec[counter]/24
phi[l,k,j,i]<-phi_vec[counter]/24
print(phi_vec[counter])
counter<-counter+1
}}} }
assert(counter==1+ l1*l2*l3*l4 )
return(psi)
}
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
x
get_phi_from_phi_vec4<-function(phi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
phi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4, l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in range3) {
for(l in range4){
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
phi[i,j,k,l]<-phi_vec[counter]/24
phi[i,j,l,k]<-phi_vec[counter]/24
phi[i,k,j,l]<-phi_vec[counter]/24
phi[i,k,l,j]<-phi_vec[counter]/24
phi[i,l,j,k]<-phi_vec[counter]/24
phi[i,l,k,j]<-phi_vec[counter]/24
phi[j,i,k,l]<-phi_vec[counter]/24
phi[j,i,l,k]<-phi_vec[counter]/24
phi[j,k,i,l]<-phi_vec[counter]/24
phi[j,k,l,i]<-phi_vec[counter]/24
phi[j,l,i,k]<-phi_vec[counter]/24
phi[j,l,k,i]<-phi_vec[counter]/24
phi[k,i,j,l]<-phi_vec[counter]/24
phi[k,i,l,j]<-phi_vec[counter]/24
phi[k,j,i,l]<-phi_vec[counter]/24
phi[k,j,l,i]<-phi_vec[counter]/24
phi[k,l,i,j]<-phi_vec[counter]/24
phi[k,l,j,i]<-phi_vec[counter]/24
phi[l,i,j,k]<-phi_vec[counter]/24
phi[l,i,k,j]<-phi_vec[counter]/24
phi[l,j,i,k]<-phi_vec[counter]/24
phi[l,j,k,i]<-phi_vec[counter]/24
phi[l,k,i,j]<-phi_vec[counter]/24
phi[l,k,j,i]<-phi_vec[counter]/24
print(phi_vec[counter])
counter<-counter+1
}}} }
assert(counter==1+ l1*l2*l3*l4,"counter error in phi " )
return(psi)
}
x<-get_phi_from_phi_vec4(phi_vec=c(1:25),l1=3,l2=2,l3=4,l4=1)
get_phi_from_phi_vec4<-function(phi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
phi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4, l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in range3) {
for(l in range4){
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
phi[i,j,k,l]<-phi_vec[counter]/24
phi[i,j,l,k]<-phi_vec[counter]/24
phi[i,k,j,l]<-phi_vec[counter]/24
phi[i,k,l,j]<-phi_vec[counter]/24
phi[i,l,j,k]<-phi_vec[counter]/24
phi[i,l,k,j]<-phi_vec[counter]/24
phi[j,i,k,l]<-phi_vec[counter]/24
phi[j,i,l,k]<-phi_vec[counter]/24
phi[j,k,i,l]<-phi_vec[counter]/24
phi[j,k,l,i]<-phi_vec[counter]/24
phi[j,l,i,k]<-phi_vec[counter]/24
phi[j,l,k,i]<-phi_vec[counter]/24
phi[k,i,j,l]<-phi_vec[counter]/24
phi[k,i,l,j]<-phi_vec[counter]/24
phi[k,j,i,l]<-phi_vec[counter]/24
phi[k,j,l,i]<-phi_vec[counter]/24
phi[k,l,i,j]<-phi_vec[counter]/24
phi[k,l,j,i]<-phi_vec[counter]/24
phi[l,i,j,k]<-phi_vec[counter]/24
phi[l,i,k,j]<-phi_vec[counter]/24
phi[l,j,i,k]<-phi_vec[counter]/24
phi[l,j,k,i]<-phi_vec[counter]/24
phi[l,k,i,j]<-phi_vec[counter]/24
phi[l,k,j,i]<-phi_vec[counter]/24
print(phi_vec[counter])
counter<-counter+1
}}} }
assert(counter==1+ l1*l2*l3*l4,"counter error in phi " )
return(phi)
}
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
x
x<-get_phi_from_phi_vec4(phi_vec=24*c(1:24),l1=3,l2=2,l3=4,l4=1)
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
x_vec<-get_phi_vec4(x,l1=3,l2=2,l3=4,l4=1)
x_vec
psi<-get_psi_from_psi_vec4(psi_vec=6*c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2),l1=1,l2=2,l3=2,l4=2)
psi_vec<-get_psi_vec4(psi, l1=1,l2=2,l3=2,l4=2)
psi_vec
#get psi table from psi_vec
get_phi_from_phi_vec4<-function(phi_vec,l1=21,l2=14,l3=2,l4=3)
{ range1<-c(1:l1)
range2<-c((l1+1):(l1+l2))
range3<-c((l1+l2+1):(l1+l2+l3))
range4<-c((l1+l2+l3+1):(l1+l2+l3+l4))
counter<-1
phi<-array(0,dim=(c(l1+l2+l3+l4,l1+l2+l3+l4,l1+l2+l3+l4, l1+l2+l3+l4)))
for (i in range1) {
for (j in range2 ) {
for (k in range3) {
for(l in range4){
#cat("i:", i, ", j:", j, ", k:", k ,'\n')
phi[i,j,k,l]<-phi_vec[counter]
phi[i,j,l,k]<-phi_vec[counter]
phi[i,k,j,l]<-phi_vec[counter]
phi[i,k,l,j]<-phi_vec[counter]
phi[i,l,j,k]<-phi_vec[counter]
phi[i,l,k,j]<-phi_vec[counter]
phi[j,i,k,l]<-phi_vec[counter]
phi[j,i,l,k]<-phi_vec[counter]
phi[j,k,i,l]<-phi_vec[counter]
phi[j,k,l,i]<-phi_vec[counter]
phi[j,l,i,k]<-phi_vec[counter]
phi[j,l,k,i]<-phi_vec[counter]
phi[k,i,j,l]<-phi_vec[counter]
phi[k,i,l,j]<-phi_vec[counter]
phi[k,j,i,l]<-phi_vec[counter]
phi[k,j,l,i]<-phi_vec[counter]
phi[k,l,i,j]<-phi_vec[counter]
phi[k,l,j,i]<-phi_vec[counter]
phi[l,i,j,k]<-phi_vec[counter]
phi[l,i,k,j]<-phi_vec[counter]
phi[l,j,i,k]<-phi_vec[counter]
phi[l,j,k,i]<-phi_vec[counter]
phi[l,k,i,j]<-phi_vec[counter]
phi[l,k,j,i]<-phi_vec[counter]
print(phi_vec[counter])
counter<-counter+1
}}} }
assert(counter==1+ l1*l2*l3*l4,"counter error in phi " )
return(phi)
}
x<-get_phi_from_phi_vec4(phi_vec=c(1:24),l1=3,l2=2,l3=4,l4=1)
x_vec<-get_phi_vec4(x,l1=3,l2=2,l3=4,l4=1)
x_vec
x
get_beta_vec_4way4(beta_3way=c(1,2,3,4),l1=1,l2=1,l3=1,l4=1, tau=1, only_beta=FALSE)
get_beta_vec_4way4<-function(beta_3way, tau, l1=21,l2=14,l3=2,l4=3, only_beta=FALSE) ## # beta_2way should be final beta_2way; #only_beta means product of beta_2ways (gamma included) without delta
{beta_vec4way<- array(0, dim = l1*l2*l3*l4 )
counter<-1
range1<-c(1:l1)
range2<-c ( (l1+1): (l1+l2) )
range3<- c( (l1+l2+1): (l1+l2+l3) )
range4 <- c ( (l1+l2+l3+1): (l1+l2+l3+l4) )
#Iterate over possible positions
for (i in range1){ #ab c/d
for (j in range2 ){
for (k in range3 ){
{for (l in range4){
beta_vec4way[counter]<-beta_3way[psi_table_position_to_vector_index4(position_tuple = c(j,k,l),l1=l1,l2=l2,l3=l3,l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,k),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,l),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,k,l),l1=l1,l2=l2,l3=l3, l4=l4)]
counter<-counter+1}}}}}
if (only_beta == FALSE)
{beta_vec4way<-beta_vec4way*tau}
assert(counter==l1*l2*l3*l4 +1)
return(beta_vec3way)
}
get_beta_vec_4way4(beta_3way=c(1,2,3,4),l1=1,l2=1,l3=1,l4=1, tau=1, only_beta=FALSE)
get_beta_vec_4way4<-function(beta_3way, tau, l1=21,l2=14,l3=2,l4=3, only_beta=FALSE) ## # beta_2way should be final beta_2way; #only_beta means product of beta_2ways (gamma included) without delta
{beta_vec4way<- array(0, dim = l1*l2*l3*l4 )
counter<-1
range1<-c(1:l1)
range2<-c ( (l1+1): (l1+l2) )
range3<- c( (l1+l2+1): (l1+l2+l3) )
range4 <- c ( (l1+l2+l3+1): (l1+l2+l3+l4) )
#Iterate over possible positions
for (i in range1){ #ab c/d
for (j in range2 ){
for (k in range3 ){
{for (l in range4){
beta_vec4way[counter]<-beta_3way[psi_table_position_to_vector_index4(position_tuple = c(j,k,l),l1=l1,l2=l2,l3=l3,l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,k),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,l),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,k,l),l1=l1,l2=l2,l3=l3, l4=l4)]
counter<-counter+1}}}}}
if (only_beta == FALSE)
{beta_vec4way<-beta_vec4way*tau}
assert(counter==l1*l2*l3*l4 +1)
return(beta_vec4way)
}
get_beta_vec_4way4(beta_3way=c(1,2,3,4),l1=1,l2=1,l3=1,l4=1, tau=1, only_beta=FALSE)
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5),l1=1,l2=1,l3=1,l4=2, tau=1, only_beta=FALSE)
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5,6,7),l1=1,l2=1,l3=1,l4=2, tau=1, only_beta=FALSE)
get_beta_vec_4way4<-function(beta_3way, tau, l1=21,l2=14,l3=2,l4=3, only_beta=FALSE) ## # beta_2way should be final beta_2way; #only_beta means product of beta_2ways (gamma included) without delta
{ assert(length(beta_3way)==l1*l2*(l3+l4) + l3*l4*(l1+l2))
beta_vec4way<- array(0, dim = l1*l2*l3*l4 )
counter<-1
range1<-c(1:l1)
range2<-c ( (l1+1): (l1+l2) )
range3<- c( (l1+l2+1): (l1+l2+l3) )
range4 <- c ( (l1+l2+l3+1): (l1+l2+l3+l4) )
#Iterate over possible positions
for (i in range1){ #ab c/d
for (j in range2 ){
for (k in range3 ){
{for (l in range4){
beta_vec4way[counter]<-beta_3way[psi_table_position_to_vector_index4(position_tuple = c(j,k,l),l1=l1,l2=l2,l3=l3,l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,k),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,l),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,k,l),l1=l1,l2=l2,l3=l3, l4=l4)]
counter<-counter+1}}}}}
if (only_beta == FALSE)
{beta_vec4way<-beta_vec4way*tau}
assert(counter==l1*l2*l3*l4 +1)
return(beta_vec4way)
}
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5,6,7),l1=1,l2=1,l3=1,l4=2, tau=1, only_beta=FALSE)
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5,6,7,8),l1=1,l2=1,l3=1,l4=2, tau=1, only_beta=FALSE)
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5,6,7),l1=1,l2=1,l3=1,l4=2, tau=1, only_beta=FALSE)
assert <- function(condition, message) {
if (!condition) stop(message)
}
get_beta_vec_4way4<-function(beta_3way, tau, l1=21,l2=14,l3=2,l4=3, only_beta=FALSE) ## # beta_2way should be final beta_2way; #only_beta means product of beta_2ways (gamma included) without delta
{ assert(length(beta_3way)==l1*l2*(l3+l4) + l3*l4*(l1+l2))
beta_vec4way<- array(0, dim = l1*l2*l3*l4 )
counter<-1
range1<-c(1:l1)
range2<-c ( (l1+1): (l1+l2) )
range3<- c( (l1+l2+1): (l1+l2+l3) )
range4 <- c ( (l1+l2+l3+1): (l1+l2+l3+l4) )
#Iterate over possible positions
for (i in range1){ #ab c/d
for (j in range2 ){
for (k in range3 ){
{for (l in range4){
beta_vec4way[counter]<-beta_3way[psi_table_position_to_vector_index4(position_tuple = c(j,k,l),l1=l1,l2=l2,l3=l3,l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,k),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,j,l),l1=l1,l2=l2,l3=l3, l4=l4)]*
beta_3way[psi_table_position_to_vector_index4(position_tuple = c(i,k,l),l1=l1,l2=l2,l3=l3, l4=l4)]
counter<-counter+1}}}}}
if (only_beta == FALSE)
{beta_vec4way<-beta_vec4way*tau}
assert(counter==l1*l2*l3*l4 +1)
return(beta_vec4way)
}
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5,6,7),l1=1,l2=1,l3=1,l4=2, tau=1, only_beta=FALSE)
get_beta_vec_4way4(beta_3way=c(1,2,3,4,5,6,7),l1=1,l2=1,l3=1,l4=2, tau=c(1,2), only_beta=FALSE)
get_positions_4way4<-function(ls_positions, l1=21,l2=14,l3=2,l4=3)
{all_positions<-c()
for (tuple in ls_positions)
{pos<-phi_table_position_to_vector_index4(position_tuple = tuple, l1=l1, l2=l2, l3=l3,l4=l4)
#print(pos)
all_positions<-c(all_positions, pos)}
return(all_positions)}
ls_pos<-list(c(1,2,4,7),c(1,3,5,7), c(1,3,6,7),  c(1,3,6,7))
get_positions_4way4(ls_pos, l1=1, l2=2, l3=3,l4=1)
ls_pos<-list(c(1,2,4,7),c(1,2,5,7), c(1,3,5,7),  c(1,3,6,7))
get_positions_4way4(ls_pos, l1=1, l2=2, l3=3,l4=1)
ls_pos<-list(c(1,2,4,7),c(1,2,5,7), c(1,3,5,7),  c(1,3,6,7))
get_positions_4way4(ls_pos, l1=1, l2=2, l3=3,l4=1)
